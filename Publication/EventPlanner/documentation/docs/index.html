<!DOCTYPE html>

<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="Event.html">
                  Event.js
                </a>
              
                
                <a class="source" href="EventClass.html">
                  EventClass.js
                </a>
              
                
                <a class="source" href="EventFunctions.html">
                  EventFunctions.js
                </a>
              
                
                <a class="source" href="TimeTable.html">
                  TimeTable.js
                </a>
              
                
                <a class="source" href="admin.html">
                  admin.js
                </a>
              
                
                <a class="source" href="attendee.html">
                  attendee.js
                </a>
              
                
                <a class="source" href="dummyFile.html">
                  dummyFile.js
                </a>
              
                
                <a class="source" href="index.html">
                  index.js
                </a>
              
                
                <a class="source" href="manager.html">
                  manager.js
                </a>
              
                
                <a class="source" href="signup.html">
                  signup.js
                </a>
              
                
                <a class="source" href="storageManager.html">
                  storageManager.js
                </a>
              
                
                <a class="source" href="storageTest.html">
                  storageTest.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>index.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>@file index.js
@date 02/21/20
@desc Handles logging in and out.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>

<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>,() =&gt; {
    <span class="hljs-keyword">let</span> notLoggedIn = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#notLoggedIn"</span>);
    <span class="hljs-keyword">let</span> loggedIn = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#loggedIn"</span>);
    <span class="hljs-keyword">let</span> loginStatus = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#loginStatus"</span>);
    <span class="hljs-keyword">let</span> logoutMessage = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#logoutMessage"</span>);
    <span class="hljs-keyword">let</span> logoutButton = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#logout"</span>);
    <span class="hljs-keyword">let</span> loginButton = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#login"</span>);
    <span class="hljs-keyword">let</span> isLoggedIn = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">let</span> loginUsername = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#username"</span>);
    <span class="hljs-keyword">let</span> loginPassword = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#password"</span>);

    <span class="hljs-keyword">let</span> createNewEvent = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#create"</span>);
    <span class="hljs-keyword">let</span> manageEvents = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#manage"</span>);
    <span class="hljs-keyword">let</span> error = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#error"</span>);

    <span class="hljs-keyword">let</span> sm = <span class="hljs-keyword">new</span> StorageManager();

    <span class="hljs-keyword">if</span>(sm.getCurrentAccount()!=<span class="hljs-string">""</span>)
    {
      <span class="hljs-keyword">if</span>(createNewEvent != <span class="hljs-literal">null</span>){
        createNewEvent.style.visibility = <span class="hljs-string">"visible"</span>;
      }
      <span class="hljs-keyword">if</span>(manageEvents != <span class="hljs-literal">null</span>){
        manageEvents.style.visibility = <span class="hljs-string">"visible"</span>;
      }
      loggedIn.style.display=<span class="hljs-string">"initial"</span>;
      isLoggedIn = <span class="hljs-literal">true</span>;
      loginStatus.innerText = <span class="hljs-string">"Currently logged in as: "</span> + sm.getCurrentAccount();
      notLoggedIn.style.display = <span class="hljs-string">"none"</span>
    }
    <span class="hljs-keyword">else</span>
    {
      <span class="hljs-keyword">if</span>(createNewEvent != <span class="hljs-literal">null</span>){
        createNewEvent.style.visibility = <span class="hljs-string">"hidden"</span>;
      }
      <span class="hljs-keyword">if</span>(manageEvents != <span class="hljs-literal">null</span>){
        manageEvents.style.visibility = <span class="hljs-string">"hidden"</span>;
      }
      loggedIn.style.display = <span class="hljs-string">"none"</span>; <span class="hljs-comment">//temporarily hide</span>
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>@pre None
@post Logs in the user or says that the username or password is incorrect</p>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p><a href="https://medium.com/javascript-in-plain-english/how-to-detect-a-sequence-of-keystrokes-in-javascript-83ec6ffd8e93">https://medium.com/javascript-in-plain-english/how-to-detect-a-sequence-of-keystrokes-in-javascript-83ec6ffd8e93</a>
the code below was mostly copied from the above source (the keydown part listener that shows the jpeg image)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">let</span> buffer = [];
      <span class="hljs-keyword">let</span> lastKeyTime = <span class="hljs-built_in">Date</span>.now();
      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'keydown'</span>, event =&gt; {
        <span class="hljs-keyword">const</span> charList = <span class="hljs-string">'biggiecheese'</span>;
        <span class="hljs-keyword">const</span> key = event.key.toLowerCase();</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>we are only interested in alphanumeric keys</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (charList.indexOf(key) === <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span>;

        <span class="hljs-keyword">const</span> currentTime = <span class="hljs-built_in">Date</span>.now();

        <span class="hljs-keyword">if</span> (currentTime - lastKeyTime &gt; <span class="hljs-number">1000</span>) {
            buffer = [];
        }

        buffer.push(key);
        lastKeyTime = currentTime;
        <span class="hljs-keyword">let</span> answer = buffer.join(<span class="hljs-string">''</span>);
        <span class="hljs-keyword">if</span>(answer == <span class="hljs-string">"biggiecheese"</span>){
            <span class="hljs-built_in">document</span>.body.style.background = <span class="hljs-string">"#f3f3f3 url('biggiecheese.jpeg') no-repeat center top"</span>;
        }

    });



    loginButton.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
        <span class="hljs-keyword">if</span> (loginUsername.value == <span class="hljs-string">""</span> || loginPassword.value == <span class="hljs-string">""</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>tell user both inputs must be filled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span>(createNewEvent != <span class="hljs-literal">null</span>){
              createNewEvent.style.visibility = <span class="hljs-string">"hidden"</span>;
            }
            <span class="hljs-keyword">if</span>(manageEvents != <span class="hljs-literal">null</span>){
              manageEvents.style.visibility = <span class="hljs-string">"hidden"</span>;
            }
            loginStatus.innerText = <span class="hljs-string">"Please fill out both fields."</span>;
            logoutMessage.style.display = <span class="hljs-string">"none"</span>;
            loggedIn.style.display = <span class="hljs-string">"initial"</span>;
            <span class="hljs-keyword">return</span>;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>check if username and password match an account in local storage, then if successful, store current account id that is logged in</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(sm.findAccount(loginUsername.value)&amp;&amp;loginPassword.value==sm.retrieveAccount(sm.getAccountId(loginUsername.value)).password)
        {
          <span class="hljs-keyword">if</span>(createNewEvent != <span class="hljs-literal">null</span>){
            createNewEvent.style.visibility = <span class="hljs-string">"visible"</span>;
          }
          <span class="hljs-keyword">if</span>(manageEvents != <span class="hljs-literal">null</span>){
            manageEvents.style.visibility = <span class="hljs-string">"visible"</span>;
          }
          isLoggedIn = <span class="hljs-literal">true</span>;
          notLoggedIn.style.display = <span class="hljs-string">"none"</span>;
          logoutMessage.style.display = <span class="hljs-string">"block"</span>;
          sm.setCurrentAccount(loginUsername.value);
          loginStatus.innerText = <span class="hljs-string">"Currently logged in as: "</span> + loginUsername.value;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!sm.findAccount(loginUsername.value)||(sm.findAccount(loginUsername.value)&amp;&amp;(sm.retrieveAccount(sm.getAccountId(loginUsername.value).password)  )))
        {
          <span class="hljs-keyword">if</span>(createNewEvent != <span class="hljs-literal">null</span>){
            createNewEvent.style.visibility = <span class="hljs-string">"hidden"</span>;
          }
          <span class="hljs-keyword">if</span>(manageEvents != <span class="hljs-literal">null</span>){
            manageEvents.style.visibility = <span class="hljs-string">"hidden"</span>;
          }
          loginStatus.innerText = <span class="hljs-string">"Incorrect Password or Username"</span>;
          logoutMessage.style.display = <span class="hljs-string">"none"</span>;
          loggedIn.style.display = <span class="hljs-string">"initial"</span>;
        }
        loggedIn.style.display = <span class="hljs-string">"initial"</span>;
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>@pre User must be logged in
@post Logs the user out</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    logoutButton.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
        <span class="hljs-keyword">if</span> (isLoggedIn)
        {
            <span class="hljs-keyword">if</span>(createNewEvent != <span class="hljs-literal">null</span>){
              createNewEvent.style.visibility = <span class="hljs-string">"hidden"</span>;
            }
            <span class="hljs-keyword">if</span>(manageEvents != <span class="hljs-literal">null</span>){
              manageEvents.style.visibility = <span class="hljs-string">"hidden"</span>;
            }
            isLoggedIn=<span class="hljs-literal">false</span>;
            sm.clearCurrentAccount();
            notLoggedIn.style.display = <span class="hljs-string">"block"</span>;
            loginStatus.innerText = <span class="hljs-string">"CloggedInurrently logged in as: "</span>;
            loggedIn.style.display = <span class="hljs-string">"none"</span>;
            loginUsername.value = <span class="hljs-string">""</span>;
            loginPassword.value = <span class="hljs-string">""</span>;
            <span class="hljs-built_in">window</span>.location.href = <span class="hljs-string">"index.html"</span>;
        }
    });
    <span class="hljs-keyword">if</span>(createNewEvent != <span class="hljs-literal">null</span>){
      createNewEvent.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
        <span class="hljs-keyword">if</span> (!isLoggedIn) {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>tell user they must be logged in to create an event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          error.innerText = <span class="hljs-string">"You must be logged in to create an event."</span>;
          <span class="hljs-keyword">return</span>;
        } <span class="hljs-keyword">else</span> {
          location.href = <span class="hljs-string">"admin.html"</span>;
        }
      });
    }
    <span class="hljs-keyword">if</span>(manageEvents != <span class="hljs-literal">null</span>){
      manageEvents.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
        <span class="hljs-keyword">if</span> (!isLoggedIn) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>tell user they must be logged in to create an event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          error.innerText = <span class="hljs-string">"You must be logged in to manage your events."</span>;
          <span class="hljs-keyword">return</span>;
        } <span class="hljs-keyword">else</span> {
          location.href = <span class="hljs-string">"manager.html"</span>;
        }
      });
    }
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
